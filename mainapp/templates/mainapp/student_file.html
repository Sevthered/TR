{% load static %}

{% block content %}
<div class="page-content-wrap">
    {% if user.profile.role == 'tutor' %}
        <p>Estudiante {{ selected_child_obj.student.Name }}</p>
    {% else %}
        <p>Estudiante {{ student.Name }}</p>
    {% endif %}
    {% if user.is_authenticated %}
        <p>Has iniciado sesión como {{ user.username }}</p>
    {% else %}
        <p>No has iniciado sesión.</p>
    {% endif %}
    <br>
    {% if children_info %}
        <form method="get" id="child-select-form">
            <label for="child-select">Select child:</label>
            <select id="child-select" name="child" onchange="document.getElementById('child-select-form').submit();">
                {% for child in children_info %}
                <option value="{{ forloop.counter0 }}" {% if forloop.counter0 == selected_child %}selected{% endif %}>
                    {{ child.student.Name }}
                </option>
                {% endfor %}
            </select>
        </form>
        
        {% if selected_child_obj %}
            {% include "mainapp/student_dashboard_content.html" with student=selected_child_obj.student grades=selected_child_obj.grades ausencias=selected_child_obj.ausencias %}
        {% endif %}
    {% else %}
        {% if is_tutor %}
            <p>No children assigned to your account.</p>
        {% else %}
            {% include "mainapp/student_dashboard_content.html" with student=student grades=grades ausencias=ausencias %}
        {% endif %}
    {% endif %}
</div>
{% endblock content %}
