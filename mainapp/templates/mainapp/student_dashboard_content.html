{% extends "base.html" %} 

{% block content %}
<div
  style="
    border: 2px solid #ccc;
    border-radius: 15px;
    padding: 20px;
    margin-top: 20px;
  "
>
  <h2>
    {{ student.Name }} {{ student.First_Surname }} {{ student.Last_Surname }}
  </h2>
  <p><strong>Email:</strong> {{ student.Email }}</p>

  <h3>Grades</h3>
  
  <a 
    href="{% url 'grade_new' %}?student_id={{ student.pk }}" 
    style="
      display: inline-block;
      padding: 10px 15px;
      margin-bottom: 10px;
      background-color: #007bff; 
      color: white;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
    "
  >
    âž• Crear Nueva Nota
  </a>

  <table
    border="1"
    cellpadding="8"
    cellspacing="0"
    style="width: 100%; margin-bottom: 20px"
  >
    <thead style="background: #f2f2f2">
      <tr>
        <th>Trimestre</th>
        <th>Nota</th>
        <th>Asignatura</th>
        <th>Profesor</th>
        <th>Comentario</th>
        <th style="width: 100px;">Acciones</th> </tr>
    </thead>
    <tbody>
      {% for grade in grades %}
      <tr>
        <td>{{ grade.trimester.Name }}</td>
        <td
          style="{% if grade.grade < 5 %}background-color: #ff6b6b; color: white;{% endif %}"
        >
          {{ grade.grade }}
        </td>
        <td>{{ grade.subject.Name }}</td>
        <td>{{ grade.teacher.Name }}</td>
        <td style="max-width: 250px; word-break: break-word">
          {{ grade.comments|default:"No hay comentario" }}
        </td>
        
        <td>
          <a 
            href="{% url 'grade_edit' grade_id=grade.pk %}"
            style="
              background-color: #28a745; 
              color: white; 
              padding: 5px 10px; 
              text-decoration: none; 
              border-radius: 3px;
              font-size: 0.9em;
            "
          >
            Modificar
          </a>
        </td>
        </tr>
      {% empty %}
      <tr>
        <td colspan="6" style="text-align: center;">No grades available.</td> </tr>
      {% endfor %}
    </tbody>
  </table>

  <h3>Absences</h3>
  <table border="1" cellpadding="8" cellspacing="0" style="width: 100%">
    <thead style="background: #f2f2f2">
      <tr>
        <th>Fecha</th>
        <th>Materia</th>
        <th>Profesor</th>
        <th>Tipo</th>
      </tr>
    </thead>
    <tbody>
      {% for ausencia in ausencias %}
      <tr>
        <td>{{ ausencia.date_time }}</td>
        <td>{{ ausencia.subject }}</td>
        <td>{{ ausencia.teacher }}</td>
        <td
          style="{% if ausencia.Tipo == 'Retraso' %}background-color: #ff6b6b; color: white;{% elif ausencia.Tipo == 'Ausencia' %}background-color: #ffa726; color: white;{% endif %}"
        >
          {{ ausencia.Tipo }}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4" style="text-align: center;">No absences recorded.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock content %}