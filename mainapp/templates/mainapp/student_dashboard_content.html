{% extends "base.html" %}
{% load static %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/global-styles.css' %}">
<style>
  :root {
    --surface-padding-vertical: 28px;
    --surface-padding-horizontal: 20px;
  }
</style>
{% endblock styles %}

{% block content %}
<div class="page-root">
    <div class="page-surface" role="main" aria-labelledby="student-name">
        {% if user.is_authenticated and user.profile.role == 'professor' %}
        <p>
            {% if return_course %}
                <button type="button" class="btn-back" onclick="window.history.back()">← Volver</button>
            {% else %}
                <button type="button" class="btn-back" onclick="window.history.back()">← Volver</button>
            {% endif %}
        </p>
        {% endif %}
        <h2 id="student-name">
            {{ student.Name }} {{ student.First_Surname }} {{ student.Last_Surname }}
        </h2>
        <p><strong>Email:</strong> {{ student.Email }}</p>

                <h3>Grades</h3>
                <div class="table-wrap">
                    <table class="table student-table" aria-describedby="grades-note">
            <thead>
                <tr>
                    <th>Trimestre</th>
                    <th>Nota</th>
                    <th>Asignatura</th>
                    <th>Profesor</th>
                    <th>Comentario</th>
                </tr>
            </thead>
            <tbody>
                {% for grade in grades %}
                        <tr>
                            <td>{{ grade.trimester.Name|default:"N/A" }}</td>
                            <td class="{% if grade.grade < 5 %}grade-fail{% endif %}">
                                {{ grade.grade }}
                            </td>
                            <td>{{ grade.subject.Name|default:"N/A" }}</td>
                            <td>{{ grade.teacher.Name|default:"N/A" }}</td>
                            <td class="comment-cell">
                                {{ grade.comments|default:"No hay comentario" }}
                            </td>
                        </tr>
                {% empty %}
                    <tr>
                        <td colspan="5" id="grades-note">No grades available.</td>
                    </tr>
                {% endfor %}
            </tbody>
                    </table>
                </div>

                <h3>Absences</h3>
                <div class="table-wrap">
                    <table class="table student-table" aria-describedby="absences-note">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Materia</th>
                    <th>Profesor</th>
                    <th>Tipo</th>
                </tr>
            </thead>
            <tbody>
                {% for ausencia in ausencias %}
                    <tr>
                        <td>{{ ausencia.date_time }}</td>
                        <td>{{ ausencia.subject }}</td>
                        <td>{{ ausencia.teacher }}</td>
                        <td class="{% if ausencia.Tipo == 'Retraso' %}absence-delay{% elif ausencia.Tipo == 'Ausencia' %}absence-absence{% endif %}">
                            {{ ausencia.Tipo }}
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="4" id="absences-note">No absences recorded.</td>
                    </tr>
                {% endfor %}
            </tbody>
                    </table>
                </div>
    </div>
</div>

{% endblock content %}
